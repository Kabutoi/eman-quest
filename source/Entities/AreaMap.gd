extends Node2D

####
# An instance of a forest/dungeon/etc. generated by a *Generator class
# Pure data, no object (eg. player, slime, etc.) scenes
####

var entrance_position = []
var transitions = [] # warps to other maps. List of MapDestination instances.
var generate_monsters_callback # funcref / callback to a method in the generator class
var tiles_wide = 0
var tiles_high = 0
var map_type = "" # eg. forest
var tile_data = [] # 2D arrays of tile names
var boss_killed = false
var tileset
var monsters = {} # Type => list of coordinates. Kept so we know what to restore when coming back after battle.
var treasure_chests # instances of TreasureChest

func _init(map_type, tileset, entrance_position, tiles_wide, tiles_high, generate_monsters_callback):
	self.tileset = tileset
	self.map_type = map_type
	self.entrance_position = entrance_position
	self.tiles_wide = tiles_wide
	self.tiles_high = tiles_high
	self.generate_monsters_callback = generate_monsters_callback

func add_tile_data(tile_data):
	self.tile_data.append(tile_data)

func generate_monsters():
	if self.generate_monsters_callback != null:
		self.monsters = self.generate_monsters_callback.call_func()
		return self.monsters
	else:
		return {}
